<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta name=viewport content="width=device-width,initial-scale=1"><title>Generate a Kubeconfig to Enable OpenShift Service Account Authentication | GUI Free Life</title><meta name=author content="Dale Bewley"><meta name=keywords content="bewley,guifreelife,openshift,kubernetes,kubeconfig,security"><meta name=description content="This post demonstrates how to properly generate kubeconfig files for OpenShift ServiceAccounts, enabling secure token-based authentication and TLS connections. You will learn how to create ServiceAccounts, generate time-limited tokens, bundle CA certificates, and package everything into a distributable kubeconfig file that can be stored as a Secret for download."><meta name=generator content="Hugo 0.119.0"><link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel=stylesheet type=text/css><link rel=stylesheet href=//use.fontawesome.com/releases/v5.11.2/css/all.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link href=/css/animate.css rel=stylesheet><link href=/css/style.turquoise.css rel=stylesheet id=theme-stylesheet><link href=/css/custom.css rel=stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link href=/css/owl.carousel.css rel=stylesheet><link href=/css/owl.theme.css rel=stylesheet><link rel=alternate href=http://guifreelife.com/index.xml type=application/rss+xml title="GUI Free Life"><meta property="og:locale" content="en_us"><meta property="og:site_name" content="GUI Free Life"><meta property="og:title" content="Generate a Kubeconfig to Enable OpenShift Service Account Authentication"><meta property="og:type" content="article"><meta property="og:url" content="http://guifreelife.com/blog/2025/04/09/Kubeconfig-for-OpenShift-Service-Accounts/"><meta property="og:description" content="This post demonstrates how to properly generate kubeconfig files for OpenShift ServiceAccounts, enabling secure token-based authentication and TLS connections. You will learn how to create ServiceAccounts, generate time-limited tokens, bundle CA certificates, and package everything into a distributable kubeconfig file that can be stored as a Secret for download."><meta property="og:image" content="http://guifreelife.com/images/kubeconfig.jpeg"><meta property="og:image:type" content="image/jpeg"><meta property="og:image:width" content="1280"><meta property="og:image:height" content="720"><meta property="og:updated_time" content="2025-04-09T00:00:00Z"><meta property="article:tag" content="openshift"><meta property="article:tag" content="kubernetes"><meta property="article:tag" content="kubeconfig"><meta property="article:tag" content="security"><meta property="article:published_time" content="2025-04-09T00:00:00Z"><meta property="article:modified_time" content="2025-04-09T00:00:00Z"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@dlbewley"><meta name=twitter:title content="Generate a Kubeconfig to Enable OpenShift Service Account …"><meta name=twitter:image content="http://guifreelife.com/images/kubeconfig.jpeg"><meta name=twitter:description content="This post demonstrates how to properly generate kubeconfig files for OpenShift ServiceAccounts, enabling secure token-based authentication and TLS connections. You will learn how to create …"><link rel=stylesheet type=text/css href=/css/asciinema-player.css><script src=/js/asciinema-player.js></script></head><body><div id=all><header class=navbar-affixed-top data-spy=affix data-offset-top=62><div class="navbar navbar-default yamm" role=navigation id=navbar><div class=container><div class=navbar-header><a class="navbar-brand home" href=/><img src=/img/logo.png alt="Generate a Kubeconfig to Enable OpenShift Service Account Authentication logo" class="hidden-xs hidden-sm">
<img src=/img/logo-small.png alt="Generate a Kubeconfig to Enable OpenShift Service Account Authentication logo" class="visible-xs visible-sm">
<span class=sr-only>Generate a Kubeconfig to Enable OpenShift Service Account Authentication - go to homepage</span></a><div class=navbar-buttons><button type=button class="navbar-toggle btn-template-main" data-toggle=collapse data-target=#navigation>
<span class=sr-only>Toggle Navigation</span>
<i class="fas fa-align-justify"></i></button></div></div><div class="navbar-collapse collapse" id=navigation><ul class="nav navbar-nav navbar-right"><li class=dropdown><a href=/>Home</a></li><li class="dropdown active"><a href=/blog/>Blog</a></li><li class=dropdown><a href=/contact/>Contact</a></li></ul></div><div class="collapse clearfix" id=search><form class=navbar-form role=search><div class=input-group><input type=text class=form-control placeholder=Search>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fas fa-search"></i></button></span></div></form></div></div></div></header><style>.bar.background-image-fixed-banner{background:url(/images/kubeconfig.jpeg)50% 0 no-repeat;background-attachment:fixed;background-size:cover;padding:100px 5%;text-shadow:2px 3px 4px var(--primary-accent),0 0 1em var(--navbar-border-top)}</style><div><div class=container><div class=row><div class=col-md-12><section class="bar background-image-fixed-banner heading h2 color-white text-center"><h1>Generate a Kubeconfig to Enable OpenShift Service Account Authentication</h1></section></div></div></div></div><div id=content><div class=container><div class=row><div class=col-md-9 id=blog-post><p class="text-muted text-uppercase mb-small text-right">April 9, 2025</p><div id=post-content><p>This post demonstrates how to properly generate kubeconfig files for OpenShift ServiceAccounts, enabling secure token-based authentication and TLS connections. You will learn how to create ServiceAccounts, generate time-limited tokens, bundle CA certificates, and package everything into a distributable kubeconfig file that can be stored as a Secret for download.</p><h1 id=creating-a-kubeconfig-for-openshift-serviceaccounts>Creating a Kubeconfig for OpenShift ServiceAccounts</h1><p>As an admin, you can generate kubeconfig files for your users to leverage with their ServiceAccounts. Here are the detailed steps. 🚶</p><h2 id=prerequisites>Prerequisites</h2><ul><li>🔧 Establish some default values</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#658b00>export</span> <span style=color:#00688b>API_SERVER</span>=<span style=color:#cd5555>&#39;api.agent.lab.bewley.net:6443&#39;</span>
</span></span><span style=display:flex><span><span style=color:#658b00>export</span> <span style=color:#00688b>SERVICE_ACCOUNT</span>=<span style=color:#cd5555>&#39;demo-sa&#39;</span>
</span></span><span style=display:flex><span><span style=color:#658b00>export</span> <span style=color:#00688b>KUBECONFIG_SA</span>=<span style=color:#cd5555>&#34;kubeconfig-</span><span style=color:#00688b>$SERVICE_ACCOUNT</span><span style=color:#cd5555>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#658b00>export</span> <span style=color:#00688b>NAMESPACE</span>=<span style=color:#cd5555>&#39;demo-kubeconfig&#39;</span>
</span></span><span style=display:flex><span><span style=color:#658b00>export</span> <span style=color:#00688b>DURATION</span>=<span style=color:#cd5555>&#39;1h&#39;</span>
</span></span></code></pre></div><ul><li>💻 Login to the cluster as admin (See <a href=http://guifreelife.com/blog/2023/09/22/Storing-OpenShift-Credentials-with-1Password/ title="Storing OpenShift Credentials with 1Password">how I manage my kubeconfigs</a>)</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#658b00>source</span> ~/.kube/ocp/agent/.env
</span></span><span style=display:flex><span><span style=color:#658b00>echo</span> <span style=color:#00688b>$KUBECONFIG</span>
</span></span><span style=display:flex><span>/Users/dale/.kube/ocp/agent/kubeconfig
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>oc config current-context
</span></span><span style=display:flex><span>default/api-agent-lab-bewley-net:6443/system:admin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>oc whoami
</span></span><span style=display:flex><span>system:admin
</span></span></code></pre></div><ul><li>🔑 Gather the API CA certificate</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#658b00>export</span> <span style=color:#00688b>API_CERT</span>=<span style=color:#8b008b;font-weight:700>$(</span>oc get secret  loadbalancer-serving-signer <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>                    -n openshift-kube-apiserver-operator <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>                    -o <span style=color:#00688b>jsonpath</span>=<span style=color:#cd5555>&#39;{.data.tls\.crt}&#39;</span> | base64 -d<span style=color:#8b008b;font-weight:700>)</span>
</span></span></code></pre></div><ul><li>🔑 Gather the ingress CA certificate</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#658b00>export</span> <span style=color:#00688b>INGRESS_CERT</span>=<span style=color:#8b008b;font-weight:700>$(</span>oc get secret router-ca <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>                        -n openshift-ingress-operator <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>                        -o <span style=color:#00688b>jsonpath</span>=<span style=color:#cd5555>&#39;{.data.tls\.crt}&#39;</span> | base64 -d<span style=color:#8b008b;font-weight:700>)</span>
</span></span></code></pre></div><ul><li>🔑 save the certificates to a bundle</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat <span style=color:#cd5555>&lt;&lt;EOF &gt; ca-bundle.crt
</span></span></span><span style=display:flex><span><span style=color:#cd5555>$API_CERT
</span></span></span><span style=display:flex><span><span style=color:#cd5555>$INGRESS_CERT
</span></span></span><span style=display:flex><span><span style=color:#cd5555>EOF</span>
</span></span></code></pre></div><ul><li>✅ You may use <code>curl</code> to verify the CA for API</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl --cacert ./ca-bundle.crt https://<span style=color:#00688b>$API_SERVER</span>/healthz 
</span></span><span style=display:flex><span>ok%  
</span></span></code></pre></div><blockquote><span class=expand><span class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(200,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'>📝 <strong>Pro Tip</strong> Viewing CA certificate details
<i class="fas fa-chevron-right"></i></span><div class=expand-content style="display:none;margin:10px 0"><p>You may use the <code>openssl x509</code> command to examine certificate details like expiration dates.</p><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ <span style=color:#658b00>echo</span> <span style=color:#00688b>$API_CERT</span> | openssl x509 -noout -dates -issuer -subject
</span></span><span style=display:flex><span><span style=color:#00688b>notBefore</span>=Mar <span style=color:#b452cd>17</span> 20:50:37 <span style=color:#b452cd>2025</span> GMT
</span></span><span style=display:flex><span><span style=color:#00688b>notAfter</span>=Mar <span style=color:#b452cd>15</span> 20:50:37 <span style=color:#b452cd>2035</span> GMT
</span></span><span style=display:flex><span><span style=color:#00688b>issuer</span>=<span style=color:#00688b>OU</span>=openshift, <span style=color:#00688b>CN</span>=kube-apiserver-lb-signer
</span></span><span style=display:flex><span><span style=color:#00688b>subject</span>=<span style=color:#00688b>OU</span>=openshift, <span style=color:#00688b>CN</span>=kube-apiserver-lb-signer
</span></span><span style=display:flex><span><span style=color:#228b22>#</span>
</span></span><span style=display:flex><span>$ <span style=color:#658b00>echo</span> <span style=color:#00688b>$INGRESS_CERT</span> | openssl x509 -noout -dates -issuer -subject 
</span></span><span style=display:flex><span><span style=color:#00688b>notBefore</span>=Mar <span style=color:#b452cd>17</span> 21:39:50 <span style=color:#b452cd>2025</span> GMT
</span></span><span style=display:flex><span><span style=color:#00688b>notAfter</span>=Mar <span style=color:#b452cd>17</span> 21:39:51 <span style=color:#b452cd>2027</span> GMT
</span></span><span style=display:flex><span><span style=color:#00688b>issuer</span>=<span style=color:#00688b>CN</span>=ingress-operator@1742247591
</span></span><span style=display:flex><span><span style=color:#00688b>subject</span>=<span style=color:#00688b>CN</span>=ingress-operator@1742247591
</span></span></code></pre></div></div></span></blockquote><h2 id=creating-a-serviceaccount-and-token>Creating a ServiceAccount and Token</h2><ul><li>🔧 Create a new project and avoied adding the new context to our current $KUBECONFIG</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>oc new-project <span style=color:#00688b>$NAMESPACE</span><span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span> --display-name=<span style=color:#cd5555>&#39;Demo SA Kubeconfig Mgmt&#39;</span><span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span> --description=<span style=color:#cd5555>&#39;See https://github.com/dlbewley/demo-kubeconfig&#39;</span><span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span> --skip-config-write
</span></span></code></pre></div><ul><li>🤖 Create a service account</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>oc create serviceaccount <span style=color:#00688b>$SERVICE_ACCOUNT</span> -n <span style=color:#00688b>$NAMESPACE</span>
</span></span></code></pre></div><blockquote><p>⚠️ <strong>Caution</strong> <em>Tokens are copyable keys!</em> Your cluster can be accessed just by having a copy of the token. You might consider setting an expiration date by using the <code>--duration</code> option when generating tokens.</p></blockquote><ul><li>🔑 Create a token for the service account that lasts for a limited duration</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#658b00>export</span> <span style=color:#00688b>TOKEN</span>=<span style=color:#8b008b;font-weight:700>$(</span>oc create token -n <span style=color:#00688b>$NAMESPACE</span> <span style=color:#00688b>$SERVICE_ACCOUNT</span> --duration=<span style=color:#00688b>$DURATION</span><span style=color:#8b008b;font-weight:700>)</span>
</span></span></code></pre></div><blockquote><span class=expand><span class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(200,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'>📝 <strong>Pro Tip</strong> If you are curious to see the JWT token contents try this:
<i class="fas fa-chevron-right"></i></span><div class=expand-content style="display:none;margin:10px 0"><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#658b00>echo</span> <span style=color:#00688b>$TOKEN</span> | cut -d <span style=color:#cd5555>&#39;.&#39;</span> -f2 | base64 -d | jq                   
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#cd5555>&#34;aud&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#cd5555>&#34;https://kubernetes.default.svc&#34;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#cd5555>&#34;exp&#34;</span>: 1744146844,
</span></span><span style=display:flex><span>  <span style=color:#cd5555>&#34;iat&#34;</span>: 1744143244,
</span></span><span style=display:flex><span>  <span style=color:#cd5555>&#34;iss&#34;</span>: <span style=color:#cd5555>&#34;https://kubernetes.default.svc&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#cd5555>&#34;jti&#34;</span>: <span style=color:#cd5555>&#34;e4510577-5955-4eb4-9f97-dec4f0e6dc34&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#cd5555>&#34;kubernetes.io&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#cd5555>&#34;namespace&#34;</span>: <span style=color:#cd5555>&#34;demo-kubeconfig&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#cd5555>&#34;serviceaccount&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#cd5555>&#34;name&#34;</span>: <span style=color:#cd5555>&#34;demo-sa&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#cd5555>&#34;uid&#34;</span>: <span style=color:#cd5555>&#34;73a74060-e67d-4b1a-ad56-e92227732d53&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#cd5555>&#34;nbf&#34;</span>: 1744143244,
</span></span><span style=display:flex><span>  <span style=color:#cd5555>&#34;sub&#34;</span>: <span style=color:#cd5555>&#34;system:serviceaccount:demo-kubeconfig:demo-sa&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#00688b>TS_ISSUED</span>=<span style=color:#8b008b;font-weight:700>$(</span><span style=color:#658b00>echo</span> <span style=color:#00688b>$TOKEN</span> | cut -d <span style=color:#cd5555>&#39;.&#39;</span> -f2 | base64 -d | jq <span style=color:#cd5555>&#39;.iat&#39;</span><span style=color:#8b008b;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#00688b>TS_EXPIRATION</span>=<span style=color:#8b008b;font-weight:700>$(</span><span style=color:#658b00>echo</span> <span style=color:#00688b>$TOKEN</span> | cut -d <span style=color:#cd5555>&#39;.&#39;</span> -f2 | base64 -d | jq <span style=color:#cd5555>&#39;.exp&#39;</span><span style=color:#8b008b;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#228b22># view the issued and expiry times</span>
</span></span><span style=display:flex><span>date -r <span style=color:#00688b>$TS_EXPIRATION</span> <span style=color:#228b22># on MacOS</span>
</span></span><span style=display:flex><span>Tue Apr  <span style=color:#b452cd>8</span> 14:14:04 PDT <span style=color:#b452cd>2025</span>
</span></span><span style=display:flex><span><span style=color:#228b22># date -d @$TS_EXPIRATION # on Linux</span>
</span></span></code></pre></div></div></span></blockquote><h2 id=generating-a-kubeconfig>Generating a Kubeconfig</h2><p>Logging into a cluster for the first time will create a kubeconfig file. By default this will be at the location defined in <code>~/.kube/config</code> or the value found in the optional $KUBECONFIG environment variable.</p><ul><li>🔧 Create kubeconfig file for $SERVICE_ACCOUNT in $NAMESPACE and avoid insecure connection by referencing the CA bundle created above</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>oc login --server=<span style=color:#00688b>$API_SERVER</span> <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>  --token=<span style=color:#00688b>$TOKEN</span> <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>  --certificate-authority=./ca-bundle.crt <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>  --kubeconfig=<span style=color:#00688b>$KUBECONFIG_SA</span>
</span></span></code></pre></div><ul><li>🔑 Insert the ca-bundle.crt into the kubeconfig file</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>oc config set-cluster <span style=color:#00688b>$API_SERVER</span> --embed-certs --certificate-authority=./ca-bundle.crt <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>  --server https://<span style=color:#00688b>$API_SERVER</span> --kubeconfig=<span style=color:#cd5555>&#34;</span><span style=color:#00688b>$KUBECONFIG_SA</span><span style=color:#cd5555>&#34;</span>
</span></span></code></pre></div><ul><li>✅ Verify that using the kubeconfig file works</li></ul><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>oc whoami --kubeconfig=<span style=color:#00688b>$KUBECONFIG_SA</span>
</span></span><span style=display:flex><span>system:serviceaccount:demo-kubeconfig:demo-sa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#228b22># 🔒 the service account will have limited permissions until RBAC is configured&#34;</span>
</span></span><span style=display:flex><span>oc get sa --kubeconfig=<span style=color:#00688b>$KUBECONFIG_SA</span>
</span></span><span style=display:flex><span>Error from server (Forbidden): serviceaccounts is forbidden:...
</span></span></code></pre></div><p>The permissions of the serviceaccount may need to be adjusted through the application of RBAC, but you can now distribute the kubeconfig.</p><h1 id=storing-the-generated-kubeconfig-in-a-secret>Storing the Generated Kubeconfig in a Secret</h1><p>The kubeconfig file may now be placed into a Secret where it can be downloaded from the OpenShift console or with the <code>oc extract</code> command.</p><div class=highlight><pre tabindex=0 style=background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>oc create secret -n <span style=color:#00688b>$NAMESPACE</span> generic <span style=color:#00688b>$KUBECONFIG_SA</span> <span style=color:#cd5555>\
</span></span></span><span style=display:flex><span><span style=color:#cd5555></span>   --from-file=<span style=color:#00688b>kubeconfig</span>=<span style=color:#00688b>$KUBECONFIG_SA</span>
</span></span><span style=display:flex><span>secret/kubeconfig-demo-sa created
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>oc describe secrets/<span style=color:#00688b>$KUBECONFIG_SA</span> -n <span style=color:#00688b>$NAMESPACE</span>
</span></span><span style=display:flex><span>Name:         kubeconfig-demo-sa
</span></span><span style=display:flex><span>Namespace:    demo-kubeconfig
</span></span><span style=display:flex><span>Labels:       &lt;none&gt;
</span></span><span style=display:flex><span>Annotations:  &lt;none&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Type:  Opaque
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00688b>Data</span>
</span></span><span style=display:flex><span>====
</span></span><span style=display:flex><span>kubeconfig:  <span style=color:#b452cd>5191</span> bytes
</span></span></code></pre></div><h1 id=demo>Demo</h1><p><strong>Demo (<a href=https://github.com/dlbewley/demo-kubeconfig/blob/main/demo-script.sh title="Demo Script">source</a>): Enabling OpenShift Service Accounts to use Token Authentication in Kubeconfigs</strong></p><blockquote><span class=expand><span class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(200,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'>📺 ASCII Screencast
<i class="fas fa-chevron-down"></i></span><div class=expand-content style="display:block;margin:10px 0"><p>Setup bridge & network attachment, create VMs, test networking, and cleanup.</p><p><asciinema-player src=/casts/kubeconfig-agent-lab-bewley-net-20250408_1649.cast cols=640 rows=50 start-at=0 speed=1 poster=npt:1:35 font-size=smaller></asciinema-player></p></div></span></blockquote><h2 id=references>References</h2><ul><li><a href=https://docs.redhat.com/en/documentation/openshift_container_platform/4.18/html/cli_tools/openshift-cli-oc#oc-create-token title="OpenShift Token Creation Documentation">Oc Token Creation</a> - OpenShift Documentation</li><li><a href=https://github.com/dlbewley/demo-kubeconfig/blob/main/demo-script.sh title="Demo Script">Demo Script</a></li><li><a href=https://github.com/dlbewley/demo-kubeconfig/tree/main title="Demo Repo">Demo Repo</a></li><li><a href=https://access.redhat.com/solutions/6998487 title="Red Hat KCS">How to create kubeconfig for a certain serviceaccount</a> - Red Hat KCS</li><li><a href=https://access.redhat.com/solutions/6992422 title="Unable to get ServiceAccount token in OpenShift 4">Unable to get ServiceAccount token in OpenShift 4</a> - Red Hat KCS</li><li><a href=https://issues.redhat.com/browse/OCPBUGS-54866 title="RFE to Add Download from Console">OpenShift RFE to Add Download from Console</a></li></ul><p><strong>See also:</strong></p><ul><li><a href=http://guifreelife.com/blog/2023/09/22/Storing-OpenShift-Credentials-with-1Password/ title="Storing OpenShift Credentials with 1Password">Storing OpenShift Credentials with 1Password</a></li><li><a href=http://guifreelife.com/blog/2023/03/09/Extracting-CA-Certs-From-Kubeconfig/ title="Extracting TLS CA Certs from Kubeconfig.md">Extracting TLS CA Certificates from Kubeconfig File</a></li></ul></div><div id=comments><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//dlbewleygithubio.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div class=col-md-3><div class="panel panel-default sidebar-menu"><div class=panel-heading><h3 class=panel-title>Search</h3></div><div class=panel-body><form action=//google.com/search method=get accept-charset=utf-8 role=search><div class=input-group><input type=search name=q class=form-control placeholder=Search>
<input type=hidden name=sitesearch value=http://guifreelife.com/>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fas fa-search"></i></button></span></div></form></div></div><div class="panel sidebar-menu"><div class=panel-heading><h3 class=panel-title>Tagged</h3></div><div class=panel-body><ul class=tag-cloud><li class=active><a href=/tags/openshift><i class="fas fa-tags"></i> openshift</a></li><li class=active><a href=/tags/kubernetes><i class="fas fa-tags"></i> kubernetes</a></li><li class=active><a href=/tags/kubeconfig><i class="fas fa-tags"></i> kubeconfig</a></li><li class=active><a href=/tags/security><i class="fas fa-tags"></i> security</a></li></ul></div></div><div class="panel sidebar-menu"><div class=panel-heading><h3 class=panel-title>TOC</h3></div><div class=panel-body><nav id=TableOfContents><ul><li><a href=#creating-a-kubeconfig-for-openshift-serviceaccounts>Creating a Kubeconfig for OpenShift ServiceAccounts</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#creating-a-serviceaccount-and-token>Creating a ServiceAccount and Token</a></li><li><a href=#generating-a-kubeconfig>Generating a Kubeconfig</a></li></ul></li><li><a href=#storing-the-generated-kubeconfig-in-a-secret>Storing the Generated Kubeconfig in a Secret</a></li><li><a href=#demo>Demo</a><ul><li><a href=#references>References</a></li></ul></li></ul></nav></div></div><div class="panel sidebar-menu"><div class=panel-heading><h3 class=panel-title>Tags</h3></div><div class=panel-body><ul class=tag-cloud><li><a href=/tags/AWS><i class="fas fa-tags"></i> AWS</a></li><li><a href=/tags/CDK><i class="fas fa-tags"></i> CDK</a></li><li><a href=/tags/OCP3><i class="fas fa-tags"></i> OCP3</a></li><li><a href=/tags/OCP4><i class="fas fa-tags"></i> OCP4</a></li><li><a href=/tags/RHACM><i class="fas fa-tags"></i> RHACM</a></li><li><a href=/tags/RHACS><i class="fas fa-tags"></i> RHACS</a></li><li><a href=/tags/RHEL><i class="fas fa-tags"></i> RHEL</a></li><li><a href=/tags/ansible><i class="fas fa-tags"></i> ansible</a></li><li><a href=/tags/automation><i class="fas fa-tags"></i> automation</a></li><li><a href=/tags/azure><i class="fas fa-tags"></i> azure</a></li><li><a href=/tags/coreos><i class="fas fa-tags"></i> coreos</a></li><li><a href=/tags/debugging><i class="fas fa-tags"></i> debugging</a></li><li><a href=/tags/docker><i class="fas fa-tags"></i> docker</a></li><li><a href=/tags/draft><i class="fas fa-tags"></i> draft</a></li><li><a href=/tags/etcd><i class="fas fa-tags"></i> etcd</a></li><li><a href=/tags/git><i class="fas fa-tags"></i> git</a></li><li><a href=/tags/haproxy><i class="fas fa-tags"></i> haproxy</a></li><li><a href=/tags/heat><i class="fas fa-tags"></i> heat</a></li><li><a href=/tags/hybrid-cloud><i class="fas fa-tags"></i> hybrid-cloud</a></li><li><a href=/tags/install><i class="fas fa-tags"></i> install</a></li><li><a href=/tags/kubeconfig><i class="fas fa-tags"></i> kubeconfig</a></li><li><a href=/tags/kubernetes><i class="fas fa-tags"></i> kubernetes</a></li><li><a href=/tags/mac><i class="fas fa-tags"></i> mac</a></li><li><a href=/tags/metrics><i class="fas fa-tags"></i> metrics</a></li><li><a href=/tags/migration><i class="fas fa-tags"></i> migration</a></li><li><a href=/tags/monitoring><i class="fas fa-tags"></i> monitoring</a></li><li><a href=/tags/networking><i class="fas fa-tags"></i> networking</a></li><li><a href=/tags/openshift><i class="fas fa-tags"></i> openshift</a></li><li><a href=/tags/openstack><i class="fas fa-tags"></i> openstack</a></li><li><a href=/tags/operators><i class="fas fa-tags"></i> operators</a></li><li><a href=/tags/prometheus><i class="fas fa-tags"></i> prometheus</a></li><li><a href=/tags/python><i class="fas fa-tags"></i> python</a></li><li><a href=/tags/router><i class="fas fa-tags"></i> router</a></li><li><a href=/tags/security><i class="fas fa-tags"></i> security</a></li><li><a href=/tags/ssl><i class="fas fa-tags"></i> ssl</a></li><li><a href=/tags/stackrox><i class="fas fa-tags"></i> stackrox</a></li><li><a href=/tags/storage><i class="fas fa-tags"></i> storage</a></li><li><a href=/tags/troubleshooting><i class="fas fa-tags"></i> troubleshooting</a></li><li><a href=/tags/upgrade><i class="fas fa-tags"></i> upgrade</a></li><li><a href=/tags/vagrant><i class="fas fa-tags"></i> vagrant</a></li><li><a href=/tags/virtualization><i class="fas fa-tags"></i> virtualization</a></li><li><a href=/tags/webinar><i class="fas fa-tags"></i> webinar</a></li><li><a href=/tags/windows><i class="fas fa-tags"></i> windows</a></li><li><a href=/tags/zabbix><i class="fas fa-tags"></i> zabbix</a></li><li><a href=/tags/zimbra><i class="fas fa-tags"></i> zimbra</a></li></ul></div></div></div></div></div></div><footer id=footer><div class=container><div class="col-md-4 col-sm-6"><h4>Share</h4><i class="fab fa-2x fa-twitter" title="Share this on Twitter" onclick='window.open("http://twitter.com/home?status=http://guifreelife.com/blog/2025/04/09/Kubeconfig-for-OpenShift-Service-Accounts/")'></i>
<i class="fab fa-2x fa-facebook" title="Share this on Facebook" onclick='window.open("http://www.facebook.com/share.php?u=http://guifreelife.com/blog/2025/04/09/Kubeconfig-for-OpenShift-Service-Accounts/")'></i>
<i class="fab fa-2x fa-linkedin" title="Share this on Linkedin" onclick='window.open("https://www.linkedin.com/shareArticle?mini=true&url=http://guifreelife.com/blog/2025/04/09/Kubeconfig-for-OpenShift-Service-Accounts/&title=&summary=&source=")'></i>
<i class="fab fa-2x fa-google-plus" title="Share this on Google Currents" onclick='window.open("https://plus.google.com/share?url=http://guifreelife.com/blog/2025/04/09/Kubeconfig-for-OpenShift-Service-Accounts/")'></i>
<i class="fa fa-2x fa-envelope" title="Share this through Email" onclick='window.open("mailto:?&body=http://guifreelife.com/blog/2025/04/09/Kubeconfig-for-OpenShift-Service-Accounts/")'></i><h4>About us</h4><p>GUI Free Life is the personal, technical blog of Dale Bewley. Comments and opinions are my own and not that of my employers.</p><hr class="hidden-md hidden-lg hidden-sm"></div><div class="col-md-4 col-sm-6"><h4>Recent posts</h4><div class=blog-entries><div class="item same-height-row clearfix"><div class="image same-height-always"><a href=http://guifreelife.com/blog/2025/06/20/CoreOS-Image-Layering-Autofs/><img src=/images/layering-cake-trans.png class=img-responsive alt="OpenShift CoreOS On-Cluster Custom Node Image Layering"></a></div><div class="name same-height-always"><h5><a href=http://guifreelife.com/blog/2025/06/20/CoreOS-Image-Layering-Autofs/>OpenShift CoreOS On-Cluster Custom Node Image Layering</a></h5></div></div><div class="item same-height-row clearfix"><div class="image same-height-always"><a href=http://guifreelife.com/blog/2025/05/29/Managing-OpenShift-Machine-Configuration-with-Butane-and-Ignition/><img src=/images/machineconfigs-butane.png class=img-responsive alt="Managing Readable OpenShift MachineConfigs with Butane"></a></div><div class="name same-height-always"><h5><a href=http://guifreelife.com/blog/2025/05/29/Managing-OpenShift-Machine-Configuration-with-Butane-and-Ignition/>Managing Readable OpenShift MachineConfigs with Butane</a></h5></div></div><div class="item same-height-row clearfix"><div class="image same-height-always"><a href=http://guifreelife.com/blog/2025/04/09/Kubeconfig-for-OpenShift-Service-Accounts/><img src=/images/kubeconfig.jpeg class=img-responsive alt="Generate a Kubeconfig to Enable OpenShift Service Account Authentication"></a></div><div class="name same-height-always"><h5><a href=http://guifreelife.com/blog/2025/04/09/Kubeconfig-for-OpenShift-Service-Accounts/>Generate a Kubeconfig to Enable OpenShift Service Account Authentication</a></h5></div></div></div><hr class="hidden-md hidden-lg"></div><div class="col-md-4 col-sm-6"><h4>Contact</h4><p class=text-uppercase><strong>Dale Bewley</strong><br>Oakland<br>California<br><strong>USA</strong></p><a href=/contact class="btn btn-small btn-template-main">Go to contact page</a><hr class="hidden-md hidden-lg hidden-sm"></div></div></footer><div id=copyright><div class=container><div class=col-md-12><p class=pull-left>Copyright (c) 2021, Dale Bewley; all rights reserved.</p><p class=pull-right>Template by <a href=https://bootstrapious.com/p/universal-business-e-commerce-template>Bootstrapious</a>.
Ported to Hugo by <a href=https://github.com/devcows/hugo-universal-theme>DevCows</a>.</p></div></div></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-39TSW9349X"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-39TSW9349X",{anonymize_ip:!1})}</script><script src=//code.jquery.com/jquery-3.1.1.min.js integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin=anonymous></script>
<script src=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js></script>
<script src="//maps.googleapis.com/maps/api/js?key=AIzaSyDacpwSIXi6lk2fS2wzZOSoh7iHm_ZP3UE&v=3.exp"></script>
<script src=/js/hpneo.gmaps.js></script>
<script src=/js/gmaps.init.js></script>
<script src=/js/front.js></script>
<script src=/js/owl.carousel.min.js></script></body></html>