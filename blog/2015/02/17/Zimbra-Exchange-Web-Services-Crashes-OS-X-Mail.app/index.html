<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta name=viewport content="width=device-width,initial-scale=1"><title>Zimbra Exchange Web Services Crashes OS X Mail.app</title><meta name=author content="DevCows"><meta name=keywords content="devows,hugo,go,mac,zimbra"><meta name=description content="Site template made by devcows using hugo"><meta name=generator content="Hugo 0.81.0"><link href="//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800" rel=stylesheet type=text/css><link rel=stylesheet href=//use.fontawesome.com/releases/v5.11.2/css/all.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link href=/css/animate.css rel=stylesheet><link href=/css/style.turquoise.css rel=stylesheet id=theme-stylesheet><link href=/css/custom.css rel=stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link href=/css/owl.carousel.css rel=stylesheet><link href=/css/owl.theme.css rel=stylesheet><link rel=alternate href=https://dwnwrd.github.io/index.xml type=application/rss+xml title="dwnwrd Universal"><meta property="og:locale" content="en_us"><meta property="og:site_name" content="dwnwrd Universal"><meta property="og:title" content="Zimbra Exchange Web Services Crashes OS X Mail.app"><meta property="og:type" content="article"><meta property="og:url" content="https://dwnwrd.github.io/blog/2015/02/17/Zimbra-Exchange-Web-Services-Crashes-OS-X-Mail.app/"><meta property="og:description" content="Site template made by devcows using hugo"><meta property="og:image" content="https://dwnwrd.github.io/img/banners/banner-24.jpg"><meta property="og:image:type" content="image/jpg"><meta property="og:image:width" content="1000"><meta property="og:image:height" content="750"><meta property="og:updated_time" content="2015-02-17T00:00:00Z"><meta property="article:tag" content="mac"><meta property="article:tag" content="zimbra"><meta property="article:published_time" content="2015-02-17T00:00:00Z"><meta property="article:modified_time" content="2015-02-17T00:00:00Z"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@dlbewley"><meta name=twitter:title content="Zimbra Exchange Web Services Crashes OS X Mail.app"><meta name=twitter:image content="https://dwnwrd.github.io/img/banners/banner-24.jpg"><meta name=twitter:description content="Site template made by devcows using hugo"></head><body><div id=all><header class=navbar-affixed-top data-spy=affix data-offset-top=62><div class="navbar navbar-default yamm" role=navigation id=navbar><div class=container><div class=navbar-header><a class="navbar-brand home" href=/><img src=/img/logo.png alt="Zimbra Exchange Web Services Crashes OS X Mail.app logo" class="hidden-xs hidden-sm">
<img src=/img/logo-small.png alt="Zimbra Exchange Web Services Crashes OS X Mail.app logo" class="visible-xs visible-sm">
<span class=sr-only>Zimbra Exchange Web Services Crashes OS X Mail.app - go to homepage</span></a><div class=navbar-buttons><button type=button class="navbar-toggle btn-template-main" data-toggle=collapse data-target=#navigation>
<span class=sr-only>Toggle Navigation</span>
<i class="fas fa-align-justify"></i></button></div></div><div class="navbar-collapse collapse" id=navigation><ul class="nav navbar-nav navbar-right"><li class=dropdown><a href=/>Home</a></li><li class="dropdown active"><a href=/blog/>Blog</a></li><li class=dropdown><a href=/contact/>Contact</a></li></ul></div><div class="collapse clearfix" id=search><form class=navbar-form role=search><div class=input-group><input type=text class=form-control placeholder=Search>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fas fa-search"></i></button></span></div></form></div></div></div></header><div id=heading-breadcrumbs><div class=container><div class=row><div class=col-md-12><h1>Zimbra Exchange Web Services Crashes OS X Mail.app</h1></div></div></div></div><div id=content><div class=container><div class=row><div class=col-md-9 id=blog-post><p class="text-muted text-uppercase mb-small text-right">February 17, 2015</p><div id=post-content><p>Zimbra <a href=http://wiki.zimbra.com/wiki/Exchange_Web_Services_EWS>added EWS support</a> in ZCS 8.5. Right around that time OS X 10.10 was released. Cool! Let&rsquo;s start syncing all our things to our brand new Mail.app, Calendar.app, and Contacts.app over HTTPS!</p><p>Strangely, <a href=https://wiki.zimbra.com/wiki/Ajcody-Apple-Mac-Issues#EWS_Configuration_And_ZCS_8.5.2B>this page</a> says that:</p><blockquote><p>ZCS 8.5 targeted EWS support ONLY with Outlook for Mac&rsquo;s. There was no testing or expectation that the native mac apps would work with the EWS configuration type.</p></blockquote><p>Really?! I hope that&rsquo;s not true. This <a href=https://blog.zimbra.com/blog/archives/2014/08/zimbra-collaboration-8-5-anytime-anywhere-device.html>blog post</a> seems to concurr, unfortunately.</p><p>I&rsquo;m gonna try it anyway. After creating an &ldquo;exchange&rdquo; account in Mail.app on Yosemite, it crashed almost immediately after startup. The only way to use existing accounts in Mail.app is to turn off the account in the Internet Accounts setting before starting Mail.app. That <a href="https://bugzilla.zimbra.com/show_bug.cgi?id=94779">bug #94779</a> was fixed in <a href=https://files.zimbra.com/website/docs/8.6/ZCS_860_NE_ReleaseNotes_UpgradeInst.pdf>ZCS 8.6.0</a>.</p><p>Cool, so I&rsquo;ll upgrade to <a href=https://files.zimbra.com/website/docs/8.6/ZCS_860_NE_ReleaseNotes_UpgradeInst.pdf>ZCS 8.6.0</a>. At first things seem awesome. Mail.app now runs more than a few seconds! Unfortunately, it will not complete downloading my entire 2GB account before it crashes. It seems like there is a parse error caused by the content of a particular message. The crash looks like this:</p><pre><code>Process:               Mail [67048]
Path:                  /Applications/Mail.app/Contents/MacOS/Mail
Identifier:            com.apple.mail
Version:               8.2 (2070.6)
Build Info:            Mail-2070006000000000~1
Code Type:             X86-64 (Native)
Parent Process:        ??? [1]
Responsible:           Mail [67048]
User ID:               1025

Date/Time:             2015-02-17 20:18:49.594 -0800
OS Version:            Mac OS X 10.10.2 (14C109)
Report Version:        11
Anonymous UUID:        97A6047A-E6A2-BD52-5661-DD0ECDCB65C1


Time Awake Since Boot: 1400000 seconds

Crashed Thread:        27  Dispatch queue: MFEWSAccountRequestResponseQueue :: NSOperation 0x6080008ae3a0 (QOS: USER_INITIATED)

Exception Type:        EXC_CRASH (SIGABRT)
Exception Codes:       0x0000000000000000, 0x0000000000000000

Application Specific Information:
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Got an invalid or absent character set for EWS MIME content, &lt;EWSMimeContentType 0x60000223c4a0&gt; {
}
'
abort() called
terminating with uncaught exception of type NSException

Application Specific Backtrace 1:
0   CoreFoundation                      0x00007fff98bef66c __exceptionPreprocess + 172
1   libobjc.A.dylib                     0x00007fff8b86976e objc_exception_throw + 43
2   CoreFoundation                      0x00007fff98bef44a +[NSException raise:format:arguments:] + 106
3   Foundation                          0x00007fff8bec93a9 -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 195
4   Mail                                0x00007fff8d67053b +[MFEWSMessage dataFromMimeContent:] + 358
5   Mail                                0x00007fff8d667c8f -[MFEWSGetItemDataResponseOperation executeOperation] + 1300
6   MailCore                            0x00007fff907de2ba -[MCMonitoredOperation main] + 234
7   Foundation                          0x00007fff8bdde32c -[__NSOperationInternal _start:] + 653
8   Foundation                          0x00007fff8bdddf33 __NSOQSchedule_f + 184
9   libdispatch.dylib                   0x00007fff906d4c13 _dispatch_client_callout + 8
10  libdispatch.dylib                   0x00007fff906d8365 _dispatch_queue_drain + 1100
11  libdispatch.dylib                   0x00007fff906d9ecc _dispatch_queue_invoke + 202
12  libdispatch.dylib                   0x00007fff906d76b7 _dispatch_root_queue_drain + 463
13  libdispatch.dylib                   0x00007fff906e5fe4 _dispatch_worker_thread3 + 91
14  libsystem_pthread.dylib             0x00007fff94234637 _pthread_wqthread + 729
15  libsystem_pthread.dylib             0x00007fff9423240d start_wqthread + 13
</code></pre><p>Is this an Apple bug or a Zimbra bug? The relevant Zimbra <a href="https://bugzilla.zimbra.com/show_bug.cgi?id=97198">bug is 97198</a>.</p><p>Before that crash above, I turned up the EWS logging to <em>debug</em> like this:</p><pre><code>[zimbra@zimbra log]$ zmprov addAccountLogger email@domain.net zimbra.ews debug
</code></pre><p>Below are the last few lines of <code>ews.log</code> when my client crashed above. They aren&rsquo;t all that interesting.</p><pre><code>2015-02-17 20:18:46,068 INFO  [qtp509886383-240825:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();EWSOperation=syncFolderItem;Folder=29346;EwsClientReqSyncState={43CD6044-B74C-3886-821D-7388FA4F7435}1;] ews - Start syncFolderItem
2015-02-17 20:18:46,068 WARN  [qtp509886383-240825:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();EWSOperation=syncFolderItem;Folder=29346;EwsClientReqSyncState={43CD6044-B74C-3886-821D-7388FA4F7435}1;] ews - SyncKey error: {43CD6044-B74C-3886-821D-7388FA4F7435}1; resetting device
2015-02-17 20:18:46,068 INFO  [qtp509886383-240825:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();EWSOperation=syncFolderItem;Folder=29346;EwsClientReqSyncState={43CD6044-B74C-3886-821D-7388FA4F7435}1;] ews - End syncFolderItem: 1
2015-02-17 20:18:46,109 DEBUG [qtp509886383-240827:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();] ews - Received GetItem from Item :30917
2015-02-17 20:18:46,111 DEBUG [qtp509886383-240827:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();] ews - Received GetItem from Item :30918
2015-02-17 20:18:46,113 DEBUG [qtp509886383-240827:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();] ews - Received GetItem from Item :30920
2015-02-17 20:18:46,115 DEBUG [qtp509886383-240827:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();] ews - Received GetItem from Item :30921
2015-02-17 20:18:46,117 DEBUG [qtp509886383-240827:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();] ews - Received GetItem from Item :30922
2015-02-17 20:18:46,119 DEBUG [qtp509886383-240827:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();] ews - Received GetItem from Item :30923
2015-02-17 20:18:46,122 INFO  [qtp509886383-240827:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();] ews - End getItem
</code></pre><p>Turn down the log level before you forget.</p><pre><code>[zimbra@zimbra log]$ zmprov removeAccountLogger email@domain.net zimbra.ews debug
</code></pre><p>Let&rsquo;s use <a href=http://wiki.zimbra.com/wiki/Zmmailbox>zmmailbox</a> to see what is in that message.</p><pre><code>[zimbra@zimbra ~]$ zmmailbox -z -m email@domain.net getMessage 30923
Id: 30923
Conversation-Id: -30923
Folder: /certification/cisco/certification
Subject: CCNP Cert Kits and Podcasts, Plus Cisco M-Learning
From: Cisco Press &lt;newsletter@ciscopress.com&gt;
To: &lt;email@domain.net&gt;
Date: Mon, 12 Apr 2010 23:31:52 -0700 (PDT)
Size: 27.73 KB

This newsletter has been formatted to be displayed in an HTML e-mail client.
If you are seeing this message your e-mail client does not support HTML.  To
see the newsletter follow this link:

http://www.ciscopress.com/newsletters/whatsnew.asp?ni=28&amp;st=47442
</code></pre><p>Let&rsquo;s see if we can find more info by <a href=http://wiki.zimbra.com/wiki/Account_mailbox_database_structure>looking at the metadata</a>.</p><pre><code>[zimbra@zimbra ~]$ zmprov getMailboxInfo email@domain.net
mailboxId: 3
quotaUsed: 2157095161
[zimbra@zimbra ~]$ expr 3 % 100
3
[zimbra@zimbra ~]$ mysql mboxgroup3
MariaDB [mboxgroup3]&gt; select * from mail_item where id=30923 \G;
*************************** 1. row ***************************
  mailbox_id: 3
          id: 30923
        type: 5
   parent_id: NULL
   folder_id: 30878
prev_folders: NULL
    index_id: 30923
     imap_id: 30923
        date: 1271140312
        size: 28400
     locator: 1
 blob_digest: I5,YgU,COUgrmv4ck1ARg37Ax3wuVLqTyp1hBiKnl6I=
      unread: 0
       flags: 0
        tags: 0
   tag_names: NULL
      sender: Cisco Press
  recipients: email@domain.net
     subject: CCNP Cert Kits and Podcasts, Plus Cisco M-Learning
        name: NULL
    metadata: d1:f153:This newsletter has been formatted to be displayed in an HTML e-mail client. If you are seeing this message your e-mail client does not support HTML. ...1:s41:&quot;Cisco Press&quot; &lt;newsletter@ciscopress.com&gt;1:t15:email@domain.net1:vi10ee
mod_metadata: 53822
 change_date: 1404997612
 mod_content: 53822
        uuid: NULL
1 row in set (0.19 sec)
</code></pre><p>I don&rsquo;t see anything obvious. I tried running it again after the crash the last line was:</p><pre><code>2015-02-17 21:56:49,493 INFO  [qtp509886383-241423:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(C)ExchangeWebServices/()Mail/();EWSOperation=syncFolderItem;Folder=29386;EwsClientReqSyncState={0A66AD5A-2B6B-31F0-8B10-D9F44BB8D80F}1;] ews - End syncFolderItem: 1
</code></pre><p>Looking at the message in the db shows some strange metadata including <em>xd.EWS_INITIAL_SYNC119:d39:MacOSX/(B)ExchangeWebServices&mldr;</em>. Is that normal?</p><pre><code>MariaDB [mboxgroup3]&gt; select * from mail_item where id=29386 \G;
*************************** 1. row ***************************
  mailbox_id: 3
          id: 29386
        type: 1
   parent_id: 29312
   folder_id: 29312
prev_folders: NULL
    index_id: NULL
     imap_id: NULL
        date: 1404996989
        size: 1
     locator: NULL
 blob_digest: NULL
      unread: 0
       flags: 0
        tags: 0
   tag_names: NULL
      sender: NULL
  recipients: NULL
     subject: buy.com
        name: buy.com
    metadata: d3:das5:false3:i4ri172463e5:mdveri17e4:mseqi50951e2:szi1878e4:unxti29388e1:vi10e2:vti5e19:xd.EWS_INITIAL_SYNC119:d39:MacOSX/(B)ExchangeWebServices/()Mail/()10:29386_true39:MacOSX/(F)ExchangeWebServices/()Mail/()10:29386_true1:vi10eee
mod_metadata: 443180
 change_date: 1424226936
 mod_content: 50948
        uuid: 1d41121e-182f-43c7-a1c0-0b4c81a3dcae
</code></pre><p><strong>EDIT</strong> 2015-05-16 This is still a problem for me with ZCS 8.6.0p2 and OSX 10.10.3.</p><pre><code>2015-05-16 20:58:29,928 DEBUG [qtp509886383-295806:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(D)ExchangeWebServices/()Mail/();] ews - Received GetItem from Item :30923
2015-05-16 20:58:29,930 INFO  [qtp509886383-295806:https://10.1.200.23:443/ews/Exchange.asmx] [name=email@domain.net;ip=10.1.200.220;ua=MacOSX/(D)ExchangeWebServices/()Mail/();] ews - End getItem
2015-05-16 20:58:30,090 INFO  [qtp509886383-295810:https://10.1.200.23:443/ews/Exchange.asmx] [] ews - User: email has been successfully authorized.
</code></pre><p>Is there anything noticably odd about item 30923? I can&rsquo;t find anything.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>mbox</span> <span style=color:#960050;background-color:#1e0010>email@domain.net&gt;</span> <span style=color:#960050;background-color:#1e0010>getmessage</span> <span style=color:#ae81ff>30923</span>
<span style=color:#960050;background-color:#1e0010>Id:</span> <span style=color:#ae81ff>30923</span>
<span style=color:#960050;background-color:#1e0010>Conversation-Id:</span> <span style=color:#ae81ff>-30923</span>
<span style=color:#960050;background-color:#1e0010>Folder:</span> <span style=color:#960050;background-color:#1e0010>/certification/cisco/certification</span>
<span style=color:#960050;background-color:#1e0010>Subject:</span> <span style=color:#960050;background-color:#1e0010>CCNP</span> <span style=color:#960050;background-color:#1e0010>Cert</span> <span style=color:#960050;background-color:#1e0010>Kits</span> <span style=color:#960050;background-color:#1e0010>and</span> <span style=color:#960050;background-color:#1e0010>Podcasts,</span> <span style=color:#960050;background-color:#1e0010>Plus</span> <span style=color:#960050;background-color:#1e0010>Cisco</span> <span style=color:#960050;background-color:#1e0010>M-Learning</span>
<span style=color:#960050;background-color:#1e0010>From:</span> <span style=color:#960050;background-color:#1e0010>Cisco</span> <span style=color:#960050;background-color:#1e0010>Press</span> <span style=color:#960050;background-color:#1e0010>&lt;newsletter@ciscopress.com&gt;</span>
<span style=color:#960050;background-color:#1e0010>To:</span> <span style=color:#960050;background-color:#1e0010>&lt;email@domain.net&gt;</span>
<span style=color:#960050;background-color:#1e0010>Date:</span> <span style=color:#960050;background-color:#1e0010>Mon,</span> <span style=color:#ae81ff>12</span> <span style=color:#960050;background-color:#1e0010>Apr</span> <span style=color:#ae81ff>2010</span> <span style=color:#ae81ff>23</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>31</span><span style=color:#960050;background-color:#1e0010>:</span><span style=color:#ae81ff>52</span> <span style=color:#ae81ff>-0700</span> <span style=color:#960050;background-color:#1e0010>(PDT)</span>
<span style=color:#960050;background-color:#1e0010>Size:</span> <span style=color:#ae81ff>27.73</span> <span style=color:#960050;background-color:#1e0010>KB</span>

<span style=color:#960050;background-color:#1e0010>This</span> <span style=color:#960050;background-color:#1e0010>newsletter</span> <span style=color:#960050;background-color:#1e0010>has</span> <span style=color:#960050;background-color:#1e0010>been</span> <span style=color:#960050;background-color:#1e0010>formatted</span> <span style=color:#960050;background-color:#1e0010>to</span> <span style=color:#960050;background-color:#1e0010>be</span> <span style=color:#960050;background-color:#1e0010>displayed</span> <span style=color:#960050;background-color:#1e0010>in</span> <span style=color:#960050;background-color:#1e0010>an</span> <span style=color:#960050;background-color:#1e0010>HTML</span> <span style=color:#960050;background-color:#1e0010>e-mail</span> <span style=color:#960050;background-color:#1e0010>client.</span>
<span style=color:#960050;background-color:#1e0010>If</span> <span style=color:#960050;background-color:#1e0010>you</span> <span style=color:#960050;background-color:#1e0010>are</span> <span style=color:#960050;background-color:#1e0010>seeing</span> <span style=color:#960050;background-color:#1e0010>this</span> <span style=color:#960050;background-color:#1e0010>message</span> <span style=color:#960050;background-color:#1e0010>your</span> <span style=color:#960050;background-color:#1e0010>e-mail</span> <span style=color:#960050;background-color:#1e0010>client</span> <span style=color:#960050;background-color:#1e0010>does</span> <span style=color:#960050;background-color:#1e0010>not</span> <span style=color:#960050;background-color:#1e0010>support</span> <span style=color:#960050;background-color:#1e0010>HTML.</span>  <span style=color:#960050;background-color:#1e0010>To</span>
<span style=color:#960050;background-color:#1e0010>see</span> <span style=color:#960050;background-color:#1e0010>the</span> <span style=color:#960050;background-color:#1e0010>newsletter</span> <span style=color:#960050;background-color:#1e0010>follow</span> <span style=color:#960050;background-color:#1e0010>this</span> <span style=color:#960050;background-color:#1e0010>link:</span>

<span style=color:#960050;background-color:#1e0010>http://www.ciscopress.com/newsletters/whatsnew.asp?ni=</span><span style=color:#ae81ff>28</span><span style=color:#960050;background-color:#1e0010>&amp;st=</span><span style=color:#ae81ff>47442</span>


<span style=color:#960050;background-color:#1e0010>mbox</span> <span style=color:#960050;background-color:#1e0010>email@domain.net&gt;</span> <span style=color:#960050;background-color:#1e0010>getmessage</span> <span style=color:#960050;background-color:#1e0010>-v</span> <span style=color:#ae81ff>30923</span>
{
     <span style=color:#f92672>&#34;addresses&#34;</span>: [
          {
               <span style=color:#f92672>&#34;address&#34;</span>: <span style=color:#e6db74>&#34;newsletter@ciscopress.com&#34;</span>,
               <span style=color:#f92672>&#34;display&#34;</span>: <span style=color:#e6db74>&#34;Cisco&#34;</span>,
               <span style=color:#f92672>&#34;fullAddressQuoted&#34;</span>: <span style=color:#e6db74>&#34;\&#34;Cisco Press\&#34; &lt;newsletter@ciscopress.com&gt;&#34;</span>,
               <span style=color:#f92672>&#34;personal&#34;</span>: <span style=color:#e6db74>&#34;Cisco Press&#34;</span>,
               <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;f&#34;</span>
          },
          {
               <span style=color:#f92672>&#34;address&#34;</span>: <span style=color:#e6db74>&#34;email@domain.net&#34;</span>,
               <span style=color:#f92672>&#34;display&#34;</span>: <span style=color:#e6db74>&#34;email&#34;</span>,
               <span style=color:#f92672>&#34;fullAddressQuoted&#34;</span>: <span style=color:#e6db74>&#34;&lt;email@domain.net&gt;&#34;</span>,
               <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;t&#34;</span>
          }
     ],
     <span style=color:#f92672>&#34;conversationId&#34;</span>: <span style=color:#e6db74>&#34;-30923&#34;</span>,
     <span style=color:#f92672>&#34;folderId&#34;</span>: <span style=color:#e6db74>&#34;30878&#34;</span>,
     <span style=color:#f92672>&#34;fragment&#34;</span>: <span style=color:#e6db74>&#34;This newsletter has been formatted to be displayed in an HTML e-mail client. If you are seeing this message your e-mail client does not support HTML. ...&#34;</span>,
     <span style=color:#f92672>&#34;hasAttachment&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;hasFlags&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;hasTags&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;30923&#34;</span>,
     <span style=color:#f92672>&#34;isDeleted&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isDraft&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isFlagged&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isForwarded&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isHighPriority&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isInvite&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isLowPriority&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isNotificationSent&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isRepliedTo&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isSentByMe&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;isUnread&#34;</span>: <span style=color:#66d9ef>false</span>,
     <span style=color:#f92672>&#34;messageIdHeader&#34;</span>: <span style=color:#e6db74>&#34;&lt;20100413065246.CFEC591690@domain.net&gt;&#34;</span>,
     <span style=color:#f92672>&#34;mimeStructure&#34;</span>: {
          <span style=color:#f92672>&#34;children&#34;</span>: [
               {
                    <span style=color:#f92672>&#34;children&#34;</span>: [],
                    <span style=color:#f92672>&#34;content&#34;</span>: <span style=color:#e6db74>&#34;This newsletter has been formatted to be displayed in an HTML e-mail client.\nIf you are seeing this message your e-mail client does not support HTML.  To\nsee the newsletter follow this link:\n\nhttp://www.ciscopress.com/newsletters/whatsnew.asp?ni=28&amp;st=47442\n&#34;</span>,
                    <span style=color:#f92672>&#34;contentType&#34;</span>: <span style=color:#e6db74>&#34;text/plain&#34;</span>,
                    <span style=color:#f92672>&#34;isBody&#34;</span>: <span style=color:#66d9ef>true</span>,
                    <span style=color:#f92672>&#34;partName&#34;</span>: <span style=color:#e6db74>&#34;1&#34;</span>,
                    <span style=color:#f92672>&#34;size&#34;</span>: <span style=color:#ae81ff>263</span>
               },
               {
                    <span style=color:#f92672>&#34;children&#34;</span>: [],
                    <span style=color:#f92672>&#34;contentType&#34;</span>: <span style=color:#e6db74>&#34;text/html&#34;</span>,
                    <span style=color:#f92672>&#34;isBody&#34;</span>: <span style=color:#66d9ef>false</span>,
                    <span style=color:#f92672>&#34;partName&#34;</span>: <span style=color:#e6db74>&#34;2&#34;</span>,
                    <span style=color:#f92672>&#34;size&#34;</span>: <span style=color:#ae81ff>26226</span>
               }
          ],
          <span style=color:#f92672>&#34;contentType&#34;</span>: <span style=color:#e6db74>&#34;multipart/alternative&#34;</span>,
          <span style=color:#f92672>&#34;isBody&#34;</span>: <span style=color:#66d9ef>false</span>,
          <span style=color:#f92672>&#34;partName&#34;</span>: <span style=color:#e6db74>&#34;TEXT&#34;</span>,
          <span style=color:#f92672>&#34;size&#34;</span>: <span style=color:#ae81ff>0</span>
     },
     <span style=color:#f92672>&#34;receivedDate&#34;</span>: <span style=color:#ae81ff>1271140312000</span>,
     <span style=color:#f92672>&#34;requestHeaders&#34;</span>: {},
     <span style=color:#f92672>&#34;sentDate&#34;</span>: <span style=color:#ae81ff>1271140312000</span>,
     <span style=color:#f92672>&#34;size&#34;</span>: <span style=color:#ae81ff>28400</span>,
     <span style=color:#f92672>&#34;subject&#34;</span>: <span style=color:#e6db74>&#34;CCNP Cert Kits and Podcasts, Plus Cisco M-Learning&#34;</span>
}
</code></pre></div><p><strong>EDIT</strong> 2015-07-07 I found out that you can get pretty extensive logging of the traffic between Mail.app and Zimbra EWS like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>/Applications/Mail.app/Contents/MacOS/Mail -LogHTTPActivity YES -LogMaximumBytes <span style=color:#ae81ff>512</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -LogEWSAutodiscoveryActivity YES &gt;&amp; ~/Desktop/EWSConnectionLog.txt
</code></pre></div><p>From that log I found the following character sets. Presumably one of these is not acceptible to <code>MailFramework/EWS/MFEWSMessage.m</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>grep Character EWSConnectionLog.txt | awk -F<span style=color:#e6db74>&#39;&gt;&#39;</span> <span style=color:#e6db74>&#39;{print $1}&#39;</span> | sort -u
                            &lt;ns2:MimeContent CharacterSet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ISO-8859-1&#34;</span>
                            &lt;ns2:MimeContent CharacterSet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;US-ASCII&#34;</span>
                            &lt;ns2:MimeContent CharacterSet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>
                            &lt;ns2:MimeContent CharacterSet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;X-UNKNOWN&#34;</span>
                            &lt;ns2:MimeContent CharacterSet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;iso-8859-1&#34;</span>
                            &lt;ns2:MimeContent CharacterSet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;us-ascii&#34;</span>
                            &lt;ns2:MimeContent CharacterSet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span>
                            &lt;ns2:MimeContent CharacterSet<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;windows-1252&#34;</span>
</code></pre></div></div><div id=comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//dlbewleygithubio.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div class=col-md-3><div class="panel panel-default sidebar-menu"><div class=panel-heading><h3 class=panel-title>Search</h3></div><div class=panel-body><form action=//google.com/search method=get accept-charset=utf-8 role=search><div class=input-group><input type=search name=q class=form-control placeholder=Search>
<input type=hidden name=sitesearch value=https://dwnwrd.github.io/>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fas fa-search"></i></button></span></div></form></div></div><div class="panel sidebar-menu"><div class=panel-heading><h3 class=panel-title>Tagged</h3></div><div class=panel-body><ul class=tag-cloud><li class=active><a href=/tags/mac><i class="fas fa-tags"></i>mac</a></li><li class=active><a href=/tags/zimbra><i class="fas fa-tags"></i>zimbra</a></li></ul></div></div><div class="panel sidebar-menu"><div class=panel-heading><h3 class=panel-title>Tags</h3></div><div class=panel-body><ul class=tag-cloud><li><a href=/tags/CDK><i class="fas fa-tags"></i>CDK</a></li><li><a href=/tags/OCP3><i class="fas fa-tags"></i>OCP3</a></li><li><a href=/tags/OCP4><i class="fas fa-tags"></i>OCP4</a></li><li><a href=/tags/OSE3><i class="fas fa-tags"></i>OSE3</a></li><li><a href=/tags/RHEL><i class="fas fa-tags"></i>RHEL</a></li><li><a href=/tags/ansible><i class="fas fa-tags"></i>ansible</a></li><li><a href=/tags/automation><i class="fas fa-tags"></i>automation</a></li><li><a href=/tags/docker><i class="fas fa-tags"></i>docker</a></li><li><a href=/tags/draft><i class="fas fa-tags"></i>draft</a></li><li><a href=/tags/etcd><i class="fas fa-tags"></i>etcd</a></li><li><a href=/tags/git><i class="fas fa-tags"></i>git</a></li><li><a href=/tags/haproxy><i class="fas fa-tags"></i>haproxy</a></li><li><a href=/tags/heat><i class="fas fa-tags"></i>heat</a></li><li><a href=/tags/install><i class="fas fa-tags"></i>install</a></li><li><a href=/tags/kubernetes><i class="fas fa-tags"></i>kubernetes</a></li><li><a href=/tags/mac><i class="fas fa-tags"></i>mac</a></li><li><a href=/tags/metrics><i class="fas fa-tags"></i>metrics</a></li><li><a href=/tags/migration><i class="fas fa-tags"></i>migration</a></li><li><a href=/tags/monitoring><i class="fas fa-tags"></i>monitoring</a></li><li><a href=/tags/networking><i class="fas fa-tags"></i>networking</a></li><li><a href=/tags/openshift><i class="fas fa-tags"></i>openshift</a></li><li><a href=/tags/openstack><i class="fas fa-tags"></i>openstack</a></li><li><a href=/tags/operators><i class="fas fa-tags"></i>operators</a></li><li><a href=/tags/python><i class="fas fa-tags"></i>python</a></li><li><a href=/tags/router><i class="fas fa-tags"></i>router</a></li><li><a href=/tags/ssl><i class="fas fa-tags"></i>ssl</a></li><li><a href=/tags/troubleshooting><i class="fas fa-tags"></i>troubleshooting</a></li><li><a href=/tags/upgrade><i class="fas fa-tags"></i>upgrade</a></li><li><a href=/tags/vagrant><i class="fas fa-tags"></i>vagrant</a></li><li><a href=/tags/zabbix><i class="fas fa-tags"></i>zabbix</a></li><li><a href=/tags/zimbra><i class="fas fa-tags"></i>zimbra</a></li></ul></div></div></div></div></div></div><footer id=footer><div class=container><div class="col-md-4 col-sm-6"><h4>About us</h4><p>GUI Free Life is the personal, technical blog of Dale Bewley. Comments and opinions are my own and not that of my employers.</p><hr class="hidden-md hidden-lg hidden-sm"></div><div class="col-md-4 col-sm-6"><h4>Recent posts</h4><div class=blog-entries><div class="item same-height-row clearfix"><div class="image same-height-always"><a href=https://dwnwrd.github.io/blog/2021/03/09/Understanding-OpenShift-Over-The-Air-Updates/><img src=/images/the-face-of-a-computer-operator-from-the-2134th-communications-squadron-is-2ca9c9.jpg class=img-responsive alt="How do OpenShift Over The Air Updates Work?"></a></div><div class="name same-height-always"><h5><a href=https://dwnwrd.github.io/blog/2021/03/09/Understanding-OpenShift-Over-The-Air-Updates/>How do OpenShift Over The Air Updates Work?</a></h5></div></div><div class="item same-height-row clearfix"><div class="image same-height-always"><a href=https://dwnwrd.github.io/blog/2020/02/15/OpenShift-4-on-OpenStack-Networking-and-Installation/><img src=/images/openshift-openstack-install-network-00.png class=img-responsive alt="OpenShift 4 on OpenStack Networking and Installation"></a></div><div class="name same-height-always"><h5><a href=https://dwnwrd.github.io/blog/2020/02/15/OpenShift-4-on-OpenStack-Networking-and-Installation/>OpenShift 4 on OpenStack Networking and Installation</a></h5></div></div><div class="item same-height-row clearfix"><div class="image same-height-always"><a href=https://dwnwrd.github.io/blog/2019/05/09/Replace-Bootstrap-Kubeconfig/><img src=/img/banners/banner-5.jpg class=img-responsive alt="Playbook to replace bootstrap.kubeconfig and node certificates on OpenShift 3.10 3.11"></a></div><div class="name same-height-always"><h5><a href=https://dwnwrd.github.io/blog/2019/05/09/Replace-Bootstrap-Kubeconfig/>Playbook to replace bootstrap.kubeconfig and node certificates on OpenShift 3.10 3.11</a></h5></div></div></div><hr class="hidden-md hidden-lg"></div><div class="col-md-4 col-sm-6"><h4>Contact</h4><p class=text-uppercase><strong>Dale Bewley</strong><br>Oakland<br>California<br><strong>USA</strong></p><a href=/contact class="btn btn-small btn-template-main">Go to contact page</a><hr class="hidden-md hidden-lg hidden-sm"></div></div></footer><div id=copyright><div class=container><div class=col-md-12><p class=pull-left>Copyright (c) 2021, Dale Bewley; all rights reserved.</p><p class=pull-right>Template by <a href=https://bootstrapious.com/p/universal-business-e-commerce-template>Bootstrapious</a>.
Ported to Hugo by <a href=https://github.com/devcows/hugo-universal-theme>DevCows</a>.</p></div></div></div></div><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-78084690-1','auto'),ga('send','pageview'))</script><script src=//code.jquery.com/jquery-3.1.1.min.js integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin=anonymous></script><script src=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js></script><script src="//maps.googleapis.com/maps/api/js?key=AIzaSyDacpwSIXi6lk2fS2wzZOSoh7iHm_ZP3UE&v=3.exp"></script><script src=/js/hpneo.gmaps.js></script><script src=/js/gmaps.init.js></script><script src=/js/front.js></script><script src=/js/owl.carousel.min.js></script></body></html>